{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: \"parkadeMain\",\n  data() {\n    return {\n      user: JSON.parse(sessionStorage.getItem(\"CurUser\")),\n      tableData: [],\n      cid: '',\n      carnumber: '',\n      vid: '',\n      iscar: '',\n      iscars: [{\n        value: 'false',\n        label: '空车'\n      }, {\n        value: 'true',\n        label: '有车'\n      }],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      centerDialogVisible: false,\n      carForm: {\n        cid: '',\n        iscar: 'false',\n        carnumber: '',\n        vid: ''\n      },\n      rules: {\n        carnumber: [{\n          required: true,\n          message: '请输入正确的车牌号',\n          trigger: 'blur'\n        }, {\n          min: 7,\n          max: 7,\n          message: '长度7个字符',\n          trigger: 'blur'\n        }, {\n          pattern: /^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    loadPost() {\n      if (this.user != null) {\n        this.$axios.post(this.$httpUrl + '/car/listAllPage', {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          param: {\n            cid: this.cid,\n            iscar: this.iscar\n          }\n        }).then(res => res.data).then(res => {\n          console.log(res);\n          if (res.code == 200) {\n            this.tableData = res.data;\n            this.total = res.total;\n          } else {\n            alert(\"数据获取失败\");\n          }\n        });\n      } else {\n        this.$confirm('未登入请登录后再进入？', '提示', {\n          confirmButtonText: '确定去登入',\n          //确认按钮文字显示\n          type: 'warning',\n          center: true,\n          //文字居中\n          showCancelButton: false,\n          //不显示取消按钮\n          closeOnClickModal: false //是否可以点击空白处关闭弹窗\n        }).then(() => {\n          this.$router.push('/');\n          sessionStorage.clear();\n        }).catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"大哥哥(姐姐)快去登录吧！！\"\n          });\n        });\n      }\n    },\n    resetForm() {\n      this.carForm.cid = '';\n      this.carForm.vid = '';\n      this.carForm.iscar = 'false';\n      this.carForm.carnumber = '';\n    },\n    resetParam() {\n      this.cid = '';\n      this.iscar = '';\n    },\n    handleClose(done) {\n      this.$confirm('确认关闭？').then(_ => {\n        done();\n      }).catch(_ => {});\n    },\n    updateCar(row) {\n      this.centerDialogVisible = true;\n      this.$nextTick(() => {\n        //赋值到表单\n        this.carForm.cid = row.cid;\n        this.carForm.vid = row.vid;\n        this.carForm.carnumber = row.carnumber;\n        this.carForm.iscar = row.iscar;\n      });\n    },\n    outCar(row) {\n      this.carForm.cid = row.cid;\n      this.carForm.carnumber = null;\n      this.carForm.iscar = 'false';\n      this.carForm.vid = '';\n      this.$axios.post(this.$httpUrl + '/car/updateCar', this.carForm).then(res => res.data).then(res => {\n        console.log(res);\n        if (res.code == 200) {\n          this.$message({\n            showClose: true,\n            message: '数据修改成功',\n            type: 'success'\n          });\n          this.loadPost();\n        } else {\n          this.$message({\n            showClose: true,\n            message: '数据修改失败',\n            type: 'error'\n          });\n        }\n      });\n    },\n    save() {\n      this.$refs.form.validate(valid => {\n        if (valid) {\n          this.$axios.post(this.$httpUrl + '/car/updateCar/43', this.carForm).then(res => res.data).then(res => {\n            console.log(res);\n            if (res.code == 200) {\n              this.$message({\n                showClose: true,\n                message: '数据修改成功',\n                type: 'success'\n              });\n              this.centerDialogVisible = false;\n              this.loadPost();\n              this.resetForm();\n            } else {\n              this.$message({\n                showClose: true,\n                message: '数据修改失败',\n                type: 'error'\n              });\n            }\n          });\n        }\n      });\n    }\n  },\n  beforeMount() {\n    this.loadPost();\n  }\n};","map":{"version":3,"names":["name","data","user","JSON","parse","sessionStorage","getItem","tableData","cid","carnumber","vid","iscar","iscars","value","label","pageNum","pageSize","total","centerDialogVisible","carForm","rules","required","message","trigger","min","max","pattern","methods","loadPost","$axios","post","$httpUrl","param","then","res","console","log","code","alert","$confirm","confirmButtonText","type","center","showCancelButton","closeOnClickModal","$router","push","clear","catch","$message","resetForm","resetParam","handleClose","done","_","updateCar","row","$nextTick","outCar","showClose","save","$refs","form","validate","valid","beforeMount"],"sources":["src/components/visitor/parkadeMain.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"margin-bottom: 5px\">\r\n      <el-input v-model=\"cid\"\r\n                placeholder=\"请输入车位编号\"\r\n                suffix-icon=\"el-icon-search\"\r\n                style=\"width: 200px\"\r\n                @keyup.enter.native=\"loadPost\"></el-input>\r\n      <el-select v-model=\"iscar\"\r\n                 filterable placeholder=\"是否空车\"\r\n                 style=\"margin-left: 5px\">\r\n        <el-option\r\n            v-for=\"item in iscars\"\r\n            :key=\"item.value\"\r\n            :label=\"item.label\"\r\n            :value=\"item.value\">\r\n        </el-option>\r\n      </el-select>\r\n      <el-button type=\"primary\"\r\n                 style=\"margin-left: 5px\"\r\n                 @click=\"loadPost\">查询</el-button>\r\n      <el-button type=\"success\"\r\n                 @click=\"resetParam\">重置</el-button>\r\n    </div>\r\n    <div>\r\n      <template>\r\n        <el-row :gutter=\"24\"  class=\"el-row\" type=\"flex\">\r\n          <el-col :span=\"8\" v-for = \"(item,index) in tableData\" :key=\"item.cid\" class=\"el-col\">\r\n            <el-card class=\"el-card\" :key=\"index\">\r\n              <div slot=\"header\" class=\"clearfix\">\r\n                <h3>{{item.cid}}号车位</h3>\r\n              </div>\r\n              <div>\r\n                <div class=\"textItem\">\r\n                  <div class=\"item_tag\" >\r\n                    <span >车主ID：</span>\r\n                  </div>\r\n                  <div class=\"item_desr\">\r\n                    <span > {{item.vid}}</span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"textItem\">\r\n                  <div class=\"item_tag\" >\r\n                    <span >车牌号：</span>\r\n                  </div>\r\n                  <div class=\"item_desr\">\r\n                    <span > {{item.carnumber}}</span>\r\n                  </div>\r\n                </div>\r\n                <div class=\"textItem\">\r\n                  <div class=\"item_tag\" >\r\n                    <span >是否空位：</span>\r\n                  </div>\r\n                  <div class=\"item_desr\">\r\n                      <el-tag\r\n                          :type=\"item.iscar === 'false' ? 'primary' : 'success'\"\r\n                          disable-transitions>{{item.iscar === 'false' ? '空位' : '有车'}}</el-tag>\r\n                  </div>\r\n                </div>\r\n                <div class=\"button\">\r\n                  <el-button size=\"small\"\r\n                             type=\"success\"\r\n                             @click=\"updateCar(item)\">登记</el-button>\r\n                  <el-popconfirm title=\"确定删除吗？\"\r\n                                 style=\"margin-left: 25px\"\r\n                                 @confirm=\"outCar(item)\">\r\n                    <el-button slot=\"reference\"\r\n                               size=\"small\"\r\n                               type=\"danger\">离开</el-button>\r\n                  </el-popconfirm>\r\n                </div>\r\n              </div>\r\n            </el-card>\r\n          </el-col>\r\n        </el-row>\r\n      </template>\r\n    </div>\r\n    <!--对话框 centerDialogVisible用来控制对话框是否出现（true表示出现）-->\r\n    <el-dialog\r\n        title=\"提示\"\r\n        :visible.sync=\"centerDialogVisible\"\r\n        width=\"30%\"\r\n        center\r\n        :before-close=\"handleClose\">\r\n      <el-form ref=\"form\" :model=\"carForm\" :rules=\"rules\" label-width=\"80px\">\r\n        <el-form-item prop=\"cid\" label=\"车位编号\">\r\n          <el-input v-model=\"carForm.cid\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"vid\" label=\"车主编号\">\r\n          <el-input v-model=\"carForm.vid\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"iscar\" label=\"是否空车\">\r\n          <el-radio-group v-model=\"carForm.iscar\">\r\n            <el-radio label=\"true\">有车</el-radio>\r\n            <el-radio label=\"false\">没车</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item prop=\"carnumber\" label=\"车牌号\">\r\n          <el-input v-model=\"carForm.carnumber\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"centerDialogVisible = false\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"save\">确 定</el-button>\r\n  </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"parkadeMain\",\r\n  data(){\r\n    return{\r\n      user : JSON.parse(sessionStorage.getItem(\"CurUser\")),\r\n      tableData:[],\r\n      cid:'',\r\n      carnumber:'',\r\n      vid:'',\r\n      iscar:'',\r\n      iscars:[\r\n        {\r\n          value: 'false',\r\n          label: '空车'\r\n        },\r\n        {\r\n          value: 'true',\r\n          label: '有车'\r\n        }\r\n      ],\r\n      pageNum:1,\r\n      pageSize:10,\r\n      total:0,\r\n      centerDialogVisible:false,\r\n      carForm:{\r\n        cid:'',\r\n        iscar:'false',\r\n        carnumber:'',\r\n        vid:''\r\n      },\r\n      rules: {\r\n        carnumber: [\r\n          { required: true, message: '请输入正确的车牌号', trigger: 'blur' },\r\n          { min: 7, max: 7, message: '长度7个字符', trigger: 'blur' },\r\n          {pattern: /^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/,\r\n            trigger: 'blur'},\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    loadPost(){\r\n      if(this.user != null){\r\n        this.$axios.post(this.$httpUrl+'/car/listAllPage',\r\n            {\r\n              pageNum:this.pageNum,\r\n              pageSize:this.pageSize,\r\n              param:{\r\n                cid:this.cid,\r\n                iscar:this.iscar\r\n              }\r\n            }\r\n        ).then(res=>res.data).then(res=>{\r\n          console.log(res);\r\n          if(res.code==200){\r\n            this.tableData = res.data;\r\n            this.total = res.total;\r\n          }else {\r\n            alert(\"数据获取失败\");\r\n          }\r\n        });\r\n      }else {\r\n        this.$confirm('未登入请登录后再进入？','提示',{\r\n          confirmButtonText:'确定去登入',//确认按钮文字显示\r\n          type:'warning',\r\n          center:true,//文字居中\r\n          showCancelButton:false,//不显示取消按钮\r\n          closeOnClickModal:false,//是否可以点击空白处关闭弹窗\r\n        }).then(()=>{\r\n          this.$router.push('/');\r\n          sessionStorage.clear();\r\n        }).catch(()=>{\r\n          this.$message({\r\n            type:\"info\",\r\n            message:\"大哥哥(姐姐)快去登录吧！！\"\r\n          });\r\n        });\r\n      }\r\n    },\r\n    resetForm(){\r\n      this.carForm.cid = '';\r\n      this.carForm.vid = '';\r\n      this.carForm.iscar = 'false';\r\n      this.carForm.carnumber = '';\r\n    },\r\n    resetParam(){\r\n      this.cid = '';\r\n      this.iscar = '';\r\n    },\r\n    handleClose(done) {\r\n      this.$confirm('确认关闭？')\r\n          .then(_ => {\r\n            done();\r\n          })\r\n          .catch(_ => {});\r\n    },\r\n    updateCar(row){\r\n        this.centerDialogVisible = true;\r\n        this.$nextTick(()=>{\r\n          //赋值到表单\r\n          this.carForm.cid = row.cid;\r\n          this.carForm.vid = row.vid;\r\n          this.carForm.carnumber = row.carnumber;\r\n          this.carForm.iscar = row.iscar;\r\n        });\r\n    },\r\n    outCar(row){\r\n        this.carForm.cid = row.cid;\r\n        this.carForm.carnumber = null;\r\n        this.carForm.iscar = 'false';\r\n        this.carForm.vid = '';\r\n      this.$axios.post(this.$httpUrl + '/car/updateCar', this.carForm)\r\n          .then(res => res.data).then(res => {\r\n        console.log(res);\r\n        if (res.code == 200) {\r\n          this.$message({\r\n            showClose: true,\r\n            message: '数据修改成功',\r\n            type: 'success'\r\n          });\r\n          this.loadPost();\r\n        } else {\r\n          this.$message({\r\n            showClose: true,\r\n            message: '数据修改失败',\r\n            type: 'error'\r\n          });\r\n        }\r\n      });\r\n    },\r\n    save(){\r\n      this.$refs.form.validate((valid) => {\r\n        if (valid) {\r\n          this.$axios.post(this.$httpUrl + '/car/updateCar/43', this.carForm)\r\n              .then(res => res.data).then(res => {\r\n            console.log(res);\r\n            if (res.code == 200) {\r\n              this.$message({\r\n                showClose: true,\r\n                message: '数据修改成功',\r\n                type: 'success'\r\n              });\r\n              this.centerDialogVisible = false;\r\n              this.loadPost();\r\n              this.resetForm();\r\n            } else {\r\n              this.$message({\r\n                showClose: true,\r\n                message: '数据修改失败',\r\n                type: 'error'\r\n              });\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n  },\r\n  beforeMount() {\r\n    this.loadPost();\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n h3 {\r\n   text-align: center;\r\n   font-family: \"Microsoft YaHei\";\r\n   color: #909399;\r\n }\r\n\r\n .button {\r\n   margin-left: 30%;\r\n }\r\n\r\n.item_tag{\r\n  float:left;\r\n  text-align:left;\r\n}\r\n.item_desr{\r\n  margin-left: 40%;\r\n  min-height: 30px;\r\n  text-align:left;\r\n}\r\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: \"\";\r\n}\r\n.clearfix:after {\r\n  clear: both\r\n}\r\n\r\n.el-card {\r\n  min-width: 100%;\r\n  height: 100%;\r\n  margin-right: 20px;\r\n}\r\n.el-card:hover{\r\n  margin-top: -5px;\r\n}\r\n.el-row {\r\n  margin-bottom: 20px;\r\n  display: flex;\r\n  flex-wrap: wrap\r\n}\r\n.el-col {\r\n  border-radius: 4px;\r\n  align-items: stretch;\r\n  margin-bottom: 40px;\r\n}\r\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}