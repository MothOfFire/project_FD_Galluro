{"ast":null,"code":"export default {\n  name: \"visitorRegisterMain\",\n  data() {\n    let checkVage = (rule, value, callback) => {\n      if (value > 150) {\n        callback(new Error('年龄过大'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      user: JSON.parse(sessionStorage.getItem(\"CurUser\")),\n      vname: '',\n      vsex: '1',\n      vsexs: [{\n        value: '1',\n        label: '男'\n      }, {\n        value: '0',\n        label: '女'\n      }],\n      vage: '',\n      vphone: '',\n      cid: '',\n      visitorForm: {\n        vname: '',\n        vsex: '1',\n        vage: '',\n        vphone: '',\n        cid: '',\n        entertime: '',\n        outtime: null,\n        status: '0'\n      },\n      rules: {\n        vname: [{\n          required: true,\n          message: '请输入游客名称',\n          trigger: 'blur'\n        }],\n        vage: [{\n          required: true,\n          message: '请输入游客年龄',\n          trigger: 'blur'\n        }, {\n          min: 1,\n          max: 3,\n          message: '长度在 1 到 3 个字符',\n          trigger: 'blur'\n        }, {\n          pattern: /^([1-9][0-9]*){1,3}$/,\n          message: '年龄必须是正整数',\n          trigger: 'blur'\n        }, {\n          validator: checkVage,\n          trigger: 'blur'\n        }],\n        vphone: [{\n          required: true,\n          message: '请输入游客的联系方式',\n          trigger: 'blur'\n        }, {\n          pattern: /^1[3|4|5|6|7|8|9][0-9]\\d{8}$/,\n          message: '请输入正确的手机号',\n          trigger: 'blur'\n        }],\n        cid: [{\n          required: false,\n          message: '请输入游客的车位号若无车位号则不用填',\n          trigger: 'blur'\n        }, {\n          min: 1,\n          max: 2,\n          message: '长度在 1 到 2 个字符',\n          trigger: 'blur'\n        }, {\n          pattern: /^([1-9][0-9]*){1,2}$/,\n          message: '工作园区编号必须是正整数',\n          trigger: 'blur'\n        }]\n      },\n      centerDialogVisible: false,\n      carForm: {\n        cid: '',\n        iscar: 'false',\n        carnumber: '',\n        vid: ''\n      },\n      rules2: {\n        carnumber: [{\n          required: true,\n          message: '请输入正确的车牌号',\n          trigger: 'blur'\n        }, {\n          min: 7,\n          max: 7,\n          message: '长度7个字符',\n          trigger: 'blur'\n        }, {\n          pattern: /^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    resetForm() {\n      this.visitorForm.vname = '';\n      this.visitorForm.vage = '';\n      this.visitorForm.vphone = '';\n      this.visitorForm.vsex = '1';\n      this.visitorForm.cid = '';\n    },\n    add() {\n      this.visitorForm.entertime = new Date();\n      //判断游客是否驾车来茶园\n      if (this.visitorForm.cid != '') {\n        this.centerDialogVisible = true;\n        this.carForm.cid = this.visitorForm.cid;\n      }\n      this.$axios.post(this.$httpUrl + '/visitor/addVisitor', this.visitorForm).then(res => res.data).then(res => {\n        console.log(res);\n        if (res.code == 200) {\n          this.resetForm();\n          this.$message({\n            showClose: true,\n            message: '数据添加成功',\n            type: 'success'\n          });\n        } else {\n          this.$message({\n            showClose: true,\n            message: '数据添加失败',\n            type: 'error'\n          });\n        }\n      });\n    },\n    handleClose(done) {\n      this.$confirm('确认关闭？').then(_ => {\n        done();\n      }).catch(_ => {});\n    }\n  }\n};","map":{"version":3,"names":["name","data","checkVage","rule","value","callback","Error","user","JSON","parse","sessionStorage","getItem","vname","vsex","vsexs","label","vage","vphone","cid","visitorForm","entertime","outtime","status","rules","required","message","trigger","min","max","pattern","validator","centerDialogVisible","carForm","iscar","carnumber","vid","rules2","methods","resetForm","add","Date","$axios","post","$httpUrl","then","res","console","log","code","$message","showClose","type","handleClose","done","$confirm","_","catch"],"sources":["src/components/visitor/visitorRegisterMain.vue"],"sourcesContent":["<template>\r\n  <div class=\"body\">\r\n    <div class=\"visitorTop\">\r\n      <h3>{{user.uname}}登记游客信息</h3>\r\n      <div>\r\n        <el-form ref=\"form\" :model=\"visitorForm\" :rules=\"rules\" label-width=\"80px\">\r\n          <el-form-item prop=\"vname\" label=\"名称\">\r\n            <el-input v-model=\"visitorForm.vname\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"vsex\" label=\"性别\">\r\n            <el-radio-group v-model=\"visitorForm.vsex\">\r\n              <el-radio label=\"1\">男</el-radio>\r\n              <el-radio label=\"0\">女</el-radio>\r\n            </el-radio-group>\r\n          </el-form-item>\r\n          <el-form-item prop=\"vage\" label=\"年龄\">\r\n            <el-input v-model=\"visitorForm.vage\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"cid\" label=\"车位号\">\r\n            <el-input v-model=\"visitorForm.cid\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"vphone\" label=\"电话\">\r\n            <el-input v-model=\"visitorForm.vphone\" style=\"width: 80%\"></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n    <div class=\"visitorButton\">\r\n      <el-button type=\"success\" @click=\"resetForm\">重 置</el-button>\r\n      <el-button type=\"primary\" @click=\"add\">确 定</el-button>\r\n    </div>\r\n    <el-dialog\r\n        title=\"提示\"\r\n        :visible.sync=\"centerDialogVisible\"\r\n        width=\"30%\"\r\n        center\r\n        :before-close=\"handleClose\">\r\n      <el-form ref=\"form\" :model=\"carForm\" :rules=\"rules2\" label-width=\"80px\">\r\n        <el-form-item prop=\"cid\" label=\"车位编号\">\r\n          <el-input v-model=\"carForm.cid\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"vid\" label=\"车主编号\">\r\n          <el-input v-model=\"carForm.vid\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item prop=\"iscar\" label=\"是否空车\">\r\n          <el-radio-group v-model=\"carForm.iscar\">\r\n            <el-radio label=\"true\">有车</el-radio>\r\n            <el-radio label=\"false\">没车</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item prop=\"carnumber\" label=\"车牌号\">\r\n          <el-input v-model=\"carForm.carnumber\" style=\"width: 80%\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"centerDialogVisible = false\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"save\">确 定</el-button>\r\n  </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"visitorRegisterMain\",\r\n  data(){\r\n    let checkVage=(rule,value,callback) => {\r\n      if(value>150){\r\n        callback(new Error('年龄过大'));\r\n      }else {\r\n        callback();\r\n      }\r\n    };\r\n    return{\r\n      user : JSON.parse(sessionStorage.getItem(\"CurUser\")),\r\n      vname:'',\r\n      vsex:'1',\r\n      vsexs:[\r\n        {\r\n          value: '1',\r\n          label: '男'\r\n        }, {\r\n          value: '0',\r\n          label: '女'\r\n        }\r\n      ],\r\n      vage:'',\r\n      vphone:'',\r\n      cid:'',\r\n      visitorForm:{\r\n        vname:'',\r\n        vsex:'1',\r\n        vage:'',\r\n        vphone:'',\r\n        cid:'',\r\n        entertime: '',\r\n        outtime:null,\r\n        status:'0'\r\n      },\r\n      rules: {\r\n        vname: [\r\n          { required: true, message: '请输入游客名称', trigger: 'blur' },\r\n        ],\r\n        vage: [\r\n          { required: true, message: '请输入游客年龄', trigger: 'blur' },\r\n          { min: 1, max: 3, message: '长度在 1 到 3 个字符', trigger: 'blur' },\r\n          {pattern: /^([1-9][0-9]*){1,3}$/,message: '年龄必须是正整数',trigger: 'blur'},\r\n          {validator: checkVage,trigger: 'blur'}\r\n        ],\r\n        vphone: [\r\n          { required: true, message: '请输入游客的联系方式', trigger: 'blur' },\r\n          { pattern: /^1[3|4|5|6|7|8|9][0-9]\\d{8}$/,message: '请输入正确的手机号',trigger: 'blur' }\r\n        ],\r\n        cid:[\r\n          { required: false, message: '请输入游客的车位号若无车位号则不用填', trigger: 'blur' },\r\n          { min: 1, max: 2, message: '长度在 1 到 2 个字符', trigger: 'blur' },\r\n          {pattern: /^([1-9][0-9]*){1,2}$/,message: '工作园区编号必须是正整数',trigger: 'blur'},\r\n        ]\r\n      },\r\n      centerDialogVisible:false,\r\n      carForm:{\r\n        cid:'',\r\n        iscar:'false',\r\n        carnumber:'',\r\n        vid:''\r\n      },\r\n      rules2: {\r\n        carnumber: [\r\n          { required: true, message: '请输入正确的车牌号', trigger: 'blur' },\r\n          { min: 7, max: 7, message: '长度7个字符', trigger: 'blur' },\r\n          {pattern: /^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/,\r\n            trigger: 'blur'},\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    resetForm(){\r\n      this.visitorForm.vname = '';\r\n      this.visitorForm.vage = '';\r\n      this.visitorForm.vphone = '';\r\n      this.visitorForm.vsex = '1';\r\n      this.visitorForm.cid = '';\r\n    },\r\n    add(){\r\n      this.visitorForm.entertime = new  Date();\r\n      //判断游客是否驾车来茶园\r\n      if(this.visitorForm.cid != ''){\r\n        this.centerDialogVisible = true;\r\n        this.carForm.cid = this.visitorForm.cid;\r\n      }\r\n      this.$axios.post(this.$httpUrl+'/visitor/addVisitor', this.visitorForm)\r\n          .then(res=>res.data).then(res=>{\r\n        console.log(res);\r\n        if(res.code==200){\r\n          this.resetForm();\r\n          this.$message({\r\n            showClose: true,\r\n            message: '数据添加成功',\r\n            type: 'success'\r\n          });\r\n        }else {\r\n          this.$message({\r\n            showClose: true,\r\n            message: '数据添加失败',\r\n            type: 'error'\r\n          });\r\n        }\r\n      });\r\n    },\r\n    handleClose(done) {\r\n      this.$confirm('确认关闭？')\r\n          .then(_ => {\r\n            done();\r\n          })\r\n          .catch(_ => {});\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n .body {\r\n   width: 70%;\r\n   height: 80%;\r\n   margin-left: 15%;\r\n   background-color: white;\r\n   border-radius: 15px;\r\n   border: gray 1px solid;\r\n   box-shadow: 0 3px 6px rgba(0, 0, 0, .12), 0 2px 6px rgba(0, 0, 0, .04);\r\n }\r\n .visitorTop {\r\n   width: 80%;\r\n   height: 60%;\r\n   margin-top: 5%;\r\n   margin-left: 10%;\r\n }\r\n h3 {\r\n   height: 10%;\r\n   width: 100%;\r\n   text-align: center;\r\n   margin-bottom: 2%;\r\n }\r\n .visitorButton {\r\n   width: 60%;\r\n   height: 10%;\r\n   margin-left: 35%;\r\n   margin-top: 3%;\r\n }\r\n</style>"],"mappings":"AA+DA;EACAA,IAAA;EACAC,KAAA;IACA,IAAAC,SAAA,GAAAA,CAAAC,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,IAAAD,KAAA;QACAC,QAAA,KAAAC,KAAA;MACA;QACAD,QAAA;MACA;IACA;IACA;MACAE,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,cAAA,CAAAC,OAAA;MACAC,KAAA;MACAC,IAAA;MACAC,KAAA,GACA;QACAV,KAAA;QACAW,KAAA;MACA;QACAX,KAAA;QACAW,KAAA;MACA,EACA;MACAC,IAAA;MACAC,MAAA;MACAC,GAAA;MACAC,WAAA;QACAP,KAAA;QACAC,IAAA;QACAG,IAAA;QACAC,MAAA;QACAC,GAAA;QACAE,SAAA;QACAC,OAAA;QACAC,MAAA;MACA;MACAC,KAAA;QACAX,KAAA,GACA;UAAAY,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAV,IAAA,GACA;UAAAQ,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAG,OAAA;UAAAJ,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAI,SAAA,EAAA5B,SAAA;UAAAwB,OAAA;QAAA,EACA;QACAT,MAAA,GACA;UAAAO,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAG,OAAA;UAAAJ,OAAA;UAAAC,OAAA;QAAA,EACA;QACAR,GAAA,GACA;UAAAM,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAG,OAAA;UAAAJ,OAAA;UAAAC,OAAA;QAAA;MAEA;MACAK,mBAAA;MACAC,OAAA;QACAd,GAAA;QACAe,KAAA;QACAC,SAAA;QACAC,GAAA;MACA;MACAC,MAAA;QACAF,SAAA,GACA;UAAAV,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAG,OAAA;UACAH,OAAA;QAAA;MAEA;IACA;EACA;EACAW,OAAA;IACAC,UAAA;MACA,KAAAnB,WAAA,CAAAP,KAAA;MACA,KAAAO,WAAA,CAAAH,IAAA;MACA,KAAAG,WAAA,CAAAF,MAAA;MACA,KAAAE,WAAA,CAAAN,IAAA;MACA,KAAAM,WAAA,CAAAD,GAAA;IACA;IACAqB,IAAA;MACA,KAAApB,WAAA,CAAAC,SAAA,OAAAoB,IAAA;MACA;MACA,SAAArB,WAAA,CAAAD,GAAA;QACA,KAAAa,mBAAA;QACA,KAAAC,OAAA,CAAAd,GAAA,QAAAC,WAAA,CAAAD,GAAA;MACA;MACA,KAAAuB,MAAA,CAAAC,IAAA,MAAAC,QAAA,+BAAAxB,WAAA,EACAyB,IAAA,CAAAC,GAAA,IAAAA,GAAA,CAAA5C,IAAA,EAAA2C,IAAA,CAAAC,GAAA;QACAC,OAAA,CAAAC,GAAA,CAAAF,GAAA;QACA,IAAAA,GAAA,CAAAG,IAAA;UACA,KAAAV,SAAA;UACA,KAAAW,QAAA;YACAC,SAAA;YACAzB,OAAA;YACA0B,IAAA;UACA;QACA;UACA,KAAAF,QAAA;YACAC,SAAA;YACAzB,OAAA;YACA0B,IAAA;UACA;QACA;MACA;IACA;IACAC,YAAAC,IAAA;MACA,KAAAC,QAAA,UACAV,IAAA,CAAAW,CAAA;QACAF,IAAA;MACA,GACAG,KAAA,CAAAD,CAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}